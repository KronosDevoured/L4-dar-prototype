<!DOCTYPE html>
<html>
<head>
  <title>Gamepad Debug Tool</title>
  <style>
    body {
      font-family: 'Courier New', monospace;
      background: #1a1a1a;
      color: #0f0;
      padding: 20px;
      margin: 0;
    }
    h1 { color: #4c8dff; }
    .status { margin: 20px 0; padding: 10px; background: #2a2a2a; }
    .buttons { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 20px 0; }
    .button {
      padding: 20px;
      background: #2a2a2a;
      border: 2px solid #3a3a3a;
      text-align: center;
    }
    .button.pressed {
      background: #4c8dff;
      color: white;
      border-color: #4c8dff;
    }
    .axes { margin: 20px 0; }
    .axis {
      margin: 10px 0;
      padding: 10px;
      background: #2a2a2a;
    }
    .axis-bar {
      width: 100%;
      height: 20px;
      background: #3a3a3a;
      position: relative;
      margin-top: 5px;
    }
    .axis-value {
      position: absolute;
      height: 100%;
      width: 4px;
      background: #4c8dff;
      left: 50%;
      transition: left 0.05s;
    }
  </style>
</head>
<body>
  <h1>Gamepad Debug Tool</h1>
  <div class="status" id="status">Waiting for gamepad...</div>

  <h2>Buttons</h2>
  <div class="buttons" id="buttons"></div>

  <h2>Axes</h2>
  <div class="axes" id="axes"></div>

  <script>
    let gamepadIndex = -1;

    window.addEventListener('gamepadconnected', (e) => {
      gamepadIndex = e.gamepad.index;
      document.getElementById('status').textContent = `Connected: ${e.gamepad.id}`;
    });

    window.addEventListener('gamepaddisconnected', (e) => {
      if (e.gamepad.index === gamepadIndex) {
        gamepadIndex = -1;
        document.getElementById('status').textContent = 'Disconnected';
      }
    });

    function update() {
      const pads = navigator.getGamepads ? navigator.getGamepads() : [];
      const pad = (gamepadIndex >= 0 && pads[gamepadIndex]) ? pads[gamepadIndex] : null;

      if (!pad) {
        requestAnimationFrame(update);
        return;
      }

      // Update buttons
      const buttonsEl = document.getElementById('buttons');
      if (buttonsEl.children.length === 0) {
        for (let i = 0; i < pad.buttons.length; i++) {
          const btn = document.createElement('div');
          btn.className = 'button';
          btn.id = `btn-${i}`;
          btn.innerHTML = `<div>Button ${i}</div><div id="btn-${i}-val">0.00</div>`;
          buttonsEl.appendChild(btn);
        }
      }

      for (let i = 0; i < pad.buttons.length; i++) {
        const btn = document.getElementById(`btn-${i}`);
        const val = document.getElementById(`btn-${i}-val`);
        if (btn && val) {
          const pressed = pad.buttons[i].pressed;
          const value = pad.buttons[i].value;
          btn.className = pressed ? 'button pressed' : 'button';
          val.textContent = value.toFixed(2);
        }
      }

      // Update axes
      const axesEl = document.getElementById('axes');
      if (axesEl.children.length === 0) {
        for (let i = 0; i < pad.axes.length; i++) {
          const axis = document.createElement('div');
          axis.className = 'axis';
          axis.innerHTML = `
            <div>Axis ${i}: <span id="axis-${i}-val">0.00</span></div>
            <div class="axis-bar">
              <div class="axis-value" id="axis-${i}-bar"></div>
            </div>
          `;
          axesEl.appendChild(axis);
        }
      }

      for (let i = 0; i < pad.axes.length; i++) {
        const val = document.getElementById(`axis-${i}-val`);
        const bar = document.getElementById(`axis-${i}-bar`);
        if (val && bar) {
          const value = pad.axes[i];
          val.textContent = value.toFixed(2);
          // Map -1..1 to 0..100%
          const percent = ((value + 1) / 2) * 100;
          bar.style.left = `${percent}%`;
        }
      }

      requestAnimationFrame(update);
    }

    update();
  </script>
</body>
</html>
